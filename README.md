# Sample application to run nestjs with graphql on azure function.

To run the app locally

```
nodenv local 18.15.0
npm i
npm run build && func host start
```

fire up [http://localhost:7071/api/graphql](http://localhost:7071/api/graphql "http://localhost:7071/api/graphql") and run a mutation

```
mutation($newRecipeData: NewRecipeInput!) {
	  addRecipe(newRecipeData: $newRecipeData) {
	    creationDate
	  }
}
```

set query variables

```
{
  "newRecipeData": {
    "title": "Salad",
    "description": "Im trying to be healthy and im disappointed in my self",
    "ingredients": ["leaves", "sadness"]
  }
}
```

you should get back something like....

```
{
  "data": {
    "addRecipe": {
      "creationDate": 1582340836192
    }
  }
}
```

# To deploy to Azure

- Change the **Application Settings** of azure function to set WEBSITE_RUN_FROM_PACKAGE to 0. This was required since the graphql schema was autogenerated when the api is requested for 1st time. When WEBSITE_RUN_FROM_PACKAGE=1, it fails to write the schema file.
- Create azure function from VS code and then deploy.
